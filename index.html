<!DOCTYPE html>
<html lang="sv">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Du hittade mig." />
    <title>Fredrik Hedberg</title>

    <!-- Typsnitt: IBM Plex Mono – avskalat, modernt, tekniskt -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400&display=swap"
      rel="stylesheet"
    />

    <style>
      /* ─── Designvariabler ─────────────────────────────────────────── */
      :root {
        --color-bg:           #f5f4f0;
        --color-text:         #2e2e2e;
        --color-subtle:       #9a9a92;
        --color-border:       #d8d7d2;
        --color-overlay-bg:   #f5f4f0f5;
        --color-illustration: #2e2e2e18;
        --font-mono:          "IBM Plex Mono", monospace;
        --spacing-base:       1.5rem;
        --transition-ease:    cubic-bezier(0.4, 0, 0.2, 1);
      }

      /* ─── Reset & bas ─────────────────────────────────────────────── */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        height: 100%;
      }

      body {
        background-color: var(--color-bg);
        color: var(--color-text);
        font-family: var(--font-mono);
        font-weight: 300;
        font-size: clamp(0.85rem, 1.5vw, 1rem);
        line-height: 1.75;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100dvh;
        padding: calc(var(--spacing-base) * 2);
      }

      /* ─── Bakgrundsillustration ───────────────────────────────────── */
      /*
        SVG:n är fixerad längs hela nederkanten.
        Innehåller: stående streck av varierande höjd (ljud/berg-metafor)
        samt en skärmflygar-ikon (fermata-form med prick nedhängd).
        Rent dekorativ – dold för skärmläsare.
      */
      .bg-illustration {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 180px;
        pointer-events: none;
        user-select: none;
        opacity: 0;
        animation: fade-in 1.2s var(--transition-ease) 2s forwards;
      }

      /* ─── Huvudcontainer ──────────────────────────────────────────── */
      .site-main {
        max-width: 36rem;
        width: 100%;
        position: relative;
        z-index: 1;
      }

      /* ─── Typografi ───────────────────────────────────────────────── */
      .label {
        font-size: 0.7rem;
        letter-spacing: 0.15em;
        text-transform: uppercase;
        color: var(--color-subtle);
        margin-bottom: calc(var(--spacing-base) * 1.5);
        opacity: 0;
        animation: fade-in 0.6s var(--transition-ease) 2.8s forwards;
      }

      .headline {
        font-size: clamp(1.4rem, 4vw, 2rem);
        font-weight: 400;
        letter-spacing: -0.02em;
        line-height: 1.3;
        margin-bottom: calc(var(--spacing-base) * 2);
        min-height: 2.6em;
      }

      .cursor {
        display: inline-block;
        width: 2px;
        height: 1em;
        background-color: var(--color-text);
        margin-left: 2px;
        vertical-align: text-bottom;
        animation: blink 1s step-end infinite;
      }

      .cursor[hidden] {
        display: none;
      }

      .tagline {
        color: var(--color-subtle);
        font-size: 0.85rem;
        margin-bottom: calc(var(--spacing-base) * 2.5);
        opacity: 0;
        animation: fade-in 0.6s var(--transition-ease) 3s forwards;
      }

      /* ─── Kontaktknapp ────────────────────────────────────────────── */
      .contact-trigger {
        display: inline-block;
        background: none;
        border: none;
        border-bottom: 1px solid var(--color-text);
        color: var(--color-text);
        font-family: var(--font-mono);
        font-size: inherit;
        font-weight: 300;
        cursor: pointer;
        padding: 0 0 2px 0;
        letter-spacing: 0.02em;
        transition: color 0.2s var(--transition-ease),
                    border-color 0.2s var(--transition-ease);
        opacity: 0;
        animation: fade-in 0.6s var(--transition-ease) 3.2s forwards;
      }

      .contact-trigger:hover,
      .contact-trigger:focus-visible {
        color: var(--color-subtle);
        border-color: var(--color-subtle);
        outline: none;
      }

      /* ─── Modal/overlay ───────────────────────────────────────────── */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background-color: var(--color-overlay-bg);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: calc(var(--spacing-base) * 2);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s var(--transition-ease);
        z-index: 100;
      }

      .modal-overlay.is-open {
        opacity: 1;
        pointer-events: all;
      }

      .modal {
        max-width: 28rem;
        width: 100%;
        transform: translateY(8px);
        transition: transform 0.3s var(--transition-ease);
        display: flex;
        flex-direction: column;
      }

      .modal-overlay.is-open .modal {
        transform: translateY(0);
      }

      .modal-label {
        font-size: 0.7rem;
        letter-spacing: 0.15em;
        text-transform: uppercase;
        color: var(--color-subtle);
        margin-bottom: var(--spacing-base);
        transition: opacity 0.3s var(--transition-ease);
      }

      .modal-label.is-hidden {
        opacity: 0;
      }

      /* ─── Formulär ────────────────────────────────────────────────── */
      .contact-form {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-base);
        transition: opacity 0.3s var(--transition-ease);
      }

      .contact-form.is-hidden {
        opacity: 0;
        pointer-events: none;
      }

      .form-field {
        display: flex;
        flex-direction: column;
        gap: 0.4rem;
      }

      .form-field label {
        font-size: 0.7rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: var(--color-subtle);
      }

      .form-field input,
      .form-field textarea {
        background: transparent;
        border: none;
        border-bottom: 1px solid var(--color-border);
        color: var(--color-text);
        font-family: var(--font-mono);
        font-size: inherit;
        font-weight: 300;
        padding: 0.5rem 0;
        width: 100%;
        resize: none;
        transition: border-color 0.2s var(--transition-ease);
        outline: none;
      }

      .form-field input:focus,
      .form-field textarea:focus {
        border-color: var(--color-text);
      }

      .form-field textarea {
        min-height: 6rem;
      }

      /* ─── Formulärknappar ─────────────────────────────────────────── */
      .form-actions {
        display: flex;
        gap: var(--spacing-base);
        align-items: center;
        padding-top: 0.5rem;
      }

      .btn-submit {
        background: none;
        border: none;
        border-bottom: 1px solid var(--color-text);
        color: var(--color-text);
        font-family: var(--font-mono);
        font-size: inherit;
        font-weight: 300;
        cursor: pointer;
        padding: 0 0 2px 0;
        letter-spacing: 0.02em;
        transition: color 0.2s var(--transition-ease),
                    border-color 0.2s var(--transition-ease);
      }

      .btn-submit:hover,
      .btn-submit:focus-visible {
        color: var(--color-subtle);
        border-color: var(--color-subtle);
        outline: none;
      }

      .btn-cancel {
        background: none;
        border: none;
        color: var(--color-subtle);
        font-family: var(--font-mono);
        font-size: 0.8rem;
        font-weight: 300;
        cursor: pointer;
        padding: 0;
        letter-spacing: 0.05em;
        transition: color 0.2s var(--transition-ease);
      }

      .btn-cancel:hover,
      .btn-cancel:focus-visible {
        color: var(--color-text);
        outline: none;
      }

      .form-confirmation {
        color: var(--color-subtle);
        font-size: 0.85rem;
        opacity: 0;
        transition: opacity 0.4s var(--transition-ease) 0.3s;
        text-align: center;
        padding: 2rem 0;
      }

      .form-confirmation.is-visible {
        opacity: 1;
      }

      /* ─── Animationer ─────────────────────────────────────────────── */
      @keyframes fade-in {
        from { opacity: 0; transform: translateY(4px); }
        to   { opacity: 1; transform: translateY(0); }
      }

      @keyframes blink {
        0%, 100% { opacity: 1; }
        50%       { opacity: 0; }
      }

      /* ─── Tillgänglighet: reducerad rörelse ───────────────────────── */
      @media (prefers-reduced-motion: reduce) {
        .label,
        .tagline,
        .contact-trigger,
        .bg-illustration {
          animation: none;
          opacity: 1;
        }
        .cursor    { animation: none; }
        .modal,
        .modal-overlay { transition: none; }
      }
    </style>
  </head>

  <body>

    <!--
      Bakgrundsillustration – två element:

      1. STÅENDE STRECK längs hela nederkanten. Höjderna följer ett mönster
         som liknar en ljudvåg / spektrumanalysator (Winamp-stil), men med
         oregelbundenheter som också för tankarna till en bergssilhuett.
         Strecken är centrerade kring en baslinje vid botten.

      2. SKÄRMFLYGARE-IKON placerad strax ovanför strecken, ungefär en
         tredjedel in från vänster. Formen är ett fermattecken: en halvcirkel
         (skärmen/vingen) med en prick (piloten) som hänger lite längre ned
         än i klassisk notation – precis som i handskissen.
    -->
    <svg
      class="bg-illustration"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 1200 180"
      preserveAspectRatio="xMidYMax meet"
      aria-hidden="true"
      focusable="false"
    >
      <defs>
        <!-- Återanvändbar färg via CSS-variabel fungerar inte i SVG fill,
             så vi hårdkodar en transparent mörkgrå (rgba 46 46 46 / 9 %) -->
        <style>
          .bar  { fill: rgba(46, 46, 46, 0.10); }
          .icon { fill: rgba(46, 46, 46, 0.18); }
        </style>
      </defs>

      <!--
        ═══════════════════════════════════════════════════════════════
        STRECKEN – 120 st, bredd 5px, gap 5px → total bredd 1200px.
        Höjderna är handtunade i tre zoner:
          • Vänster (0–35):   lägre, tätare variation – lugn zon
          • Mitten (36–80):   höga toppar, dramatisk – bergszon
          • Höger (81–119):   jämna, rytmiska – musikzon
        Varje rekt är förankrad vid botten (y + höjd = 180).
        ═══════════════════════════════════════════════════════════════
      -->

      <!-- Vänster zon – varierande men lägre -->
      <rect class="bar" x="0"    y="162" width="5" height="18"/>
      <rect class="bar" x="10"   y="158" width="5" height="22"/>
      <rect class="bar" x="20"   y="165" width="5" height="15"/>
      <rect class="bar" x="30"   y="155" width="5" height="25"/>
      <rect class="bar" x="40"   y="160" width="5" height="20"/>
      <rect class="bar" x="50"   y="152" width="5" height="28"/>
      <rect class="bar" x="60"   y="158" width="5" height="22"/>
      <rect class="bar" x="70"   y="164" width="5" height="16"/>
      <rect class="bar" x="80"   y="150" width="5" height="30"/>
      <rect class="bar" x="90"   y="157" width="5" height="23"/>
      <rect class="bar" x="100"  y="163" width="5" height="17"/>
      <rect class="bar" x="110"  y="148" width="5" height="32"/>
      <rect class="bar" x="120"  y="155" width="5" height="25"/>
      <rect class="bar" x="130"  y="161" width="5" height="19"/>
      <rect class="bar" x="140"  y="145" width="5" height="35"/>
      <rect class="bar" x="150"  y="153" width="5" height="27"/>
      <rect class="bar" x="160"  y="159" width="5" height="21"/>
      <rect class="bar" x="170"  y="143" width="5" height="37"/>
      <rect class="bar" x="180"  y="151" width="5" height="29"/>
      <rect class="bar" x="190"  y="157" width="5" height="23"/>
      <rect class="bar" x="200"  y="162" width="5" height="18"/>
      <rect class="bar" x="210"  y="148" width="5" height="32"/>
      <rect class="bar" x="220"  y="155" width="5" height="25"/>
      <rect class="bar" x="230"  y="140" width="5" height="40"/>
      <rect class="bar" x="240"  y="150" width="5" height="30"/>
      <rect class="bar" x="250"  y="158" width="5" height="22"/>
      <rect class="bar" x="260"  y="138" width="5" height="42"/>
      <rect class="bar" x="270"  y="148" width="5" height="32"/>
      <rect class="bar" x="280"  y="156" width="5" height="24"/>
      <rect class="bar" x="290"  y="135" width="5" height="45"/>
      <rect class="bar" x="300"  y="146" width="5" height="34"/>
      <rect class="bar" x="310"  y="153" width="5" height="27"/>
      <rect class="bar" x="320"  y="132" width="5" height="48"/>
      <rect class="bar" x="330"  y="143" width="5" height="37"/>
      <rect class="bar" x="340"  y="151" width="5" height="29"/>

      <!-- Mittzon – höga dramatiska toppar (bergssilhuett) -->
      <rect class="bar" x="350"  y="125" width="5" height="55"/>
      <rect class="bar" x="360"  y="138" width="5" height="42"/>
      <rect class="bar" x="370"  y="112" width="5" height="68"/>
      <rect class="bar" x="380"  y="130" width="5" height="50"/>
      <rect class="bar" x="390"  y="148" width="5" height="32"/>
      <rect class="bar" x="400"  y="105" width="5" height="75"/>
      <rect class="bar" x="410"  y="125" width="5" height="55"/>
      <rect class="bar" x="420"  y="145" width="5" height="35"/>
      <rect class="bar" x="430"  y="98"  width="5" height="82"/>
      <rect class="bar" x="440"  y="118" width="5" height="62"/>
      <rect class="bar" x="450"  y="140" width="5" height="40"/>
      <rect class="bar" x="460"  y="90"  width="5" height="90"/>
      <rect class="bar" x="470"  y="112" width="5" height="68"/>
      <rect class="bar" x="480"  y="135" width="5" height="45"/>
      <rect class="bar" x="490"  y="85"  width="5" height="95"/>
      <rect class="bar" x="500"  y="108" width="5" height="72"/>
      <rect class="bar" x="510"  y="130" width="5" height="50"/>
      <rect class="bar" x="520"  y="92"  width="5" height="88"/>
      <rect class="bar" x="530"  y="115" width="5" height="65"/>
      <rect class="bar" x="540"  y="138" width="5" height="42"/>
      <rect class="bar" x="550"  y="100" width="5" height="80"/>
      <rect class="bar" x="560"  y="122" width="5" height="58"/>
      <rect class="bar" x="570"  y="143" width="5" height="37"/>
      <rect class="bar" x="580"  y="110" width="5" height="70"/>
      <rect class="bar" x="590"  y="130" width="5" height="50"/>
      <rect class="bar" x="600"  y="150" width="5" height="30"/>
      <rect class="bar" x="610"  y="118" width="5" height="62"/>
      <rect class="bar" x="620"  y="138" width="5" height="42"/>
      <rect class="bar" x="630"  y="155" width="5" height="25"/>
      <rect class="bar" x="640"  y="128" width="5" height="52"/>
      <rect class="bar" x="650"  y="145" width="5" height="35"/>
      <rect class="bar" x="660"  y="160" width="5" height="20"/>

      <!-- Höger zon – jämnare, rytmisk musikvåg -->
      <rect class="bar" x="670"  y="145" width="5" height="35"/>
      <rect class="bar" x="680"  y="132" width="5" height="48"/>
      <rect class="bar" x="690"  y="155" width="5" height="25"/>
      <rect class="bar" x="700"  y="140" width="5" height="40"/>
      <rect class="bar" x="710"  y="125" width="5" height="55"/>
      <rect class="bar" x="720"  y="148" width="5" height="32"/>
      <rect class="bar" x="730"  y="135" width="5" height="45"/>
      <rect class="bar" x="740"  y="120" width="5" height="60"/>
      <rect class="bar" x="750"  y="145" width="5" height="35"/>
      <rect class="bar" x="760"  y="132" width="5" height="48"/>
      <rect class="bar" x="770"  y="115" width="5" height="65"/>
      <rect class="bar" x="780"  y="140" width="5" height="40"/>
      <rect class="bar" x="790"  y="128" width="5" height="52"/>
      <rect class="bar" x="800"  y="112" width="5" height="68"/>
      <rect class="bar" x="810"  y="138" width="5" height="42"/>
      <rect class="bar" x="820"  y="125" width="5" height="55"/>
      <rect class="bar" x="830"  y="108" width="5" height="72"/>
      <rect class="bar" x="840"  y="135" width="5" height="45"/>
      <rect class="bar" x="850"  y="122" width="5" height="58"/>
      <rect class="bar" x="860"  y="105" width="5" height="75"/>
      <rect class="bar" x="870"  y="132" width="5" height="48"/>
      <rect class="bar" x="880"  y="118" width="5" height="62"/>
      <rect class="bar" x="890"  y="102" width="5" height="78"/>
      <rect class="bar" x="900"  y="128" width="5" height="52"/>
      <rect class="bar" x="910"  y="115" width="5" height="65"/>
      <rect class="bar" x="920"  y="100" width="5" height="80"/>
      <rect class="bar" x="930"  y="125" width="5" height="55"/>
      <rect class="bar" x="940"  y="112" width="5" height="68"/>
      <rect class="bar" x="950"  y="138" width="5" height="42"/>
      <rect class="bar" x="960"  y="122" width="5" height="58"/>
      <rect class="bar" x="970"  y="108" width="5" height="72"/>
      <rect class="bar" x="980"  y="135" width="5" height="45"/>
      <rect class="bar" x="990"  y="120" width="5" height="60"/>
      <rect class="bar" x="1000" y="105" width="5" height="75"/>
      <rect class="bar" x="1010" y="132" width="5" height="48"/>
      <rect class="bar" x="1020" y="118" width="5" height="62"/>
      <rect class="bar" x="1030" y="145" width="5" height="35"/>
      <rect class="bar" x="1040" y="128" width="5" height="52"/>
      <rect class="bar" x="1050" y="115" width="5" height="65"/>
      <rect class="bar" x="1060" y="142" width="5" height="38"/>
      <rect class="bar" x="1070" y="125" width="5" height="55"/>
      <rect class="bar" x="1080" y="150" width="5" height="30"/>
      <rect class="bar" x="1090" y="135" width="5" height="45"/>
      <rect class="bar" x="1100" y="155" width="5" height="25"/>
      <rect class="bar" x="1110" y="140" width="5" height="40"/>
      <rect class="bar" x="1120" y="160" width="5" height="20"/>
      <rect class="bar" x="1130" y="148" width="5" height="32"/>
      <rect class="bar" x="1140" y="162" width="5" height="18"/>
      <rect class="bar" x="1150" y="155" width="5" height="25"/>
      <rect class="bar" x="1160" y="165" width="5" height="15"/>
      <rect class="bar" x="1170" y="158" width="5" height="22"/>
      <rect class="bar" x="1180" y="163" width="5" height="17"/>
      <rect class="bar" x="1190" y="168" width="5" height="12"/>

      <!--
        ═══════════════════════════════════════════════════════════════
        SKÄRMFLYGARE-IKON – fermataform med nedhängande prick.
        Placerad ca 1/3 in från vänster, strax ovanför strecken.
        Centrum: x=390, bågtopp: y=18

        Bågen: halvcirkel med radie 38, öppen nedåt.
        Pricken: cirkel r=6, placerad 22px under bågcentrum
                 (jämfört med klassisk fermat där den sitter tätt).
        ═══════════════════════════════════════════════════════════════
      -->
      <!--
        Skärmflygare vid 30 % av ursprunglig storlek (scale 0.3).
        Bågen är en ca 1/3-cirkel (120°): radie 42, startvinkel -60°,
        slutvinkel +60° → x-koordinater ±21, y-koordinat -36.37.
        Pricken (pilot) hänger 6.6px under centrum (22 × 0.3).
        Stroke-width skalas med samma faktor → 1.5px.
      -->
      <!--
        Bågen är ca 1/4-cirkel (90°): radie 42, startvinkel -45°, slutvinkel +45°
        → x: ±29.7, y: -29.7. Mellanting mellan halvcirkel och 1/3-cirkel.
        Storlek: scale(0.45) – något större än 0.3 men fortfarande diskret.
      -->
      <g class="icon" transform="translate(390, 75) scale(0.45)">
        <path d="M -39.4,-14.4 A 42,42 0 0 1 39.4,-14.4" stroke="rgba(46,46,46,0.18)" stroke-width="5" fill="none" stroke-linecap="round"/>
        <circle cx="0" cy="22" r="6"/>
      </g>

    </svg>

    <main class="site-main" aria-label="Startsida">

      <p class="label" aria-hidden="true">fredrikhedberg.se</p>

      <h1
        class="headline"
        aria-label="Du hittade mig. Skapar musik. Flyger skärm. Hör av dig."
      >
        <!-- Fylls i dynamiskt av typewriter-scriptet -->
      </h1>

      <p class="tagline">— Fredrik Hedberg</p>

      <button
        class="contact-trigger"
        type="button"
        aria-haspopup="dialog"
        aria-controls="contact-modal"
      >
        kontakta mig
      </button>

    </main>

    <!-- ─── Kontaktmodal ───────────────────────────────────────────── -->
    <div
      class="modal-overlay"
      id="contact-modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-heading"
      aria-hidden="true"
    >
      <div class="modal">
        <p class="modal-label" id="modal-heading">kontakt</p>

        <!--
          Byt ut action-URL mot din Formspree-endpoint.
          Skapa konto på formspree.io och ersätt DITT_FORMSPREE_ID.
        -->
        <form
          class="contact-form"
          id="contact-form"
          action="https://formspree.io/f/mojnbbag"
          method="POST"
        >
          <div class="form-field">
            <label for="field-name">namn</label>
            <input
              type="text"
              id="field-name"
              name="name"
              autocomplete="name"
              required
            />
          </div>

          <div class="form-field">
            <label for="field-email">e-post</label>
            <input
              type="email"
              id="field-email"
              name="email"
              autocomplete="email"
              required
            />
          </div>

          <div class="form-field">
            <label for="field-message">meddelande</label>
            <textarea
              id="field-message"
              name="message"
              rows="4"
              required
            ></textarea>
          </div>

          <div class="form-actions">
            <button class="btn-submit" type="submit">skicka</button>
            <button class="btn-cancel" type="button" id="modal-close">avbryt</button>
          </div>
        </form>

        <p class="form-confirmation" id="form-confirmation">
          tack. jag hör av mig.
        </p>

      </div>
    </div>

    <script>
      (() => {
        "use strict";

        // ─── Typewriter ──────────────────────────────────────────────
        //
        // Sekvensen är uppdelad i segment. Varje segment har:
        //   text       – det som skrivs ut (\n = radbrytning)
        //   pauseAfter – ms att vänta efter segmentet är klart
        //
        const headline    = document.querySelector(".headline");
        const typingSpeed = 45; // ms per tecken

        const sequence = [
          { text: "Du hittade mig.",                pauseAfter: 900 },
          { text: "\n",                             pauseAfter: 0   },
          { text: "\nSkapar musik.\nFlyger skärm.", pauseAfter: 700 },
          { text: "\nHör av dig.",                  pauseAfter: 0   },
        ];

        // Platt version för tillgänglighet (prefers-reduced-motion)
        const fullTextFlat = "Du hittade mig. Skapar musik. Flyger skärm. Hör av dig.";

        function runTypewriter() {
          const cursor = document.createElement("span");
          cursor.className = "cursor";
          cursor.setAttribute("aria-hidden", "true");
          headline.appendChild(cursor);

          function runSegment(segmentIndex) {
            if (segmentIndex >= sequence.length) {
              setTimeout(() => cursor.setAttribute("hidden", ""), 1000);
              return;
            }

            const { text, pauseAfter } = sequence[segmentIndex];
            let charIndex = 0;

            function typeNextChar() {
              if (charIndex < text.length) {
                const char = text[charIndex];
                if (char === "\n") {
                  headline.insertBefore(document.createElement("br"), cursor);
                } else {
                  headline.insertBefore(document.createTextNode(char), cursor);
                }
                charIndex++;
                setTimeout(typeNextChar, typingSpeed);
              } else {
                setTimeout(() => runSegment(segmentIndex + 1), pauseAfter);
              }
            }

            typeNextChar();
          }

          setTimeout(() => runSegment(0), 400);
        }

        if (window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
          headline.textContent = fullTextFlat;
        } else {
          runTypewriter();
        }

        // ─── Modal ───────────────────────────────────────────────────
        const overlay      = document.getElementById("contact-modal");
        const openBtn      = document.querySelector(".contact-trigger");
        const closeBtn     = document.getElementById("modal-close");
        const form         = document.getElementById("contact-form");
        const confirmation = document.getElementById("form-confirmation");

        function openModal() {
          // Återställ formulär och rubrik inför varje öppning
          const modalLabel = document.querySelector(".modal-label");
          form.hidden       = false;
          form.reset();
          form.classList.remove("is-hidden");
          modalLabel.hidden = false;
          modalLabel.classList.remove("is-hidden");
          confirmation.classList.remove("is-visible");

          overlay.classList.add("is-open");
          overlay.setAttribute("aria-hidden", "false");
          overlay.querySelector("input, button").focus();
        }

        function closeModal() {
          overlay.classList.remove("is-open");
          overlay.setAttribute("aria-hidden", "true");
          openBtn.focus();
        }

        openBtn.addEventListener("click", openModal);
        closeBtn.addEventListener("click", closeModal);

        overlay.addEventListener("click", (event) => {
          if (event.target === overlay) closeModal();
        });

        document.addEventListener("keydown", (event) => {
          if (event.key === "Escape" && overlay.classList.contains("is-open")) {
            closeModal();
          }
        });

        // ─── Formulärskickning via fetch (AJAX) ──────────────────────
        form.addEventListener("submit", async (event) => {
          event.preventDefault();

          // Skicka data till Formspree
          const data     = new FormData(form);
          const endpoint = form.getAttribute("action");

          // Animera bort formulär + rubrik, sedan fram tacktexten
          const modalLabel = document.querySelector(".modal-label");
          form.classList.add("is-hidden");
          modalLabel.classList.add("is-hidden");
          setTimeout(() => {
            form.hidden       = true;
            modalLabel.hidden = true;
            confirmation.classList.add("is-visible");
          }, 300);

          try {
            await fetch(endpoint, {
              method: "POST",
              body: data,
              headers: { Accept: "application/json" },
            });
          } catch {
            // Tyst fel – bekräftelsen visas ändå
          }
        });

      })();
    </script>
  </body>
</html>
